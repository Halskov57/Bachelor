(opret bruger)
sequenceDiagram
    actor Bruger
    participant Frontend
    participant Backend
    participant Database

    Bruger->>Frontend: Udfylder oprettelsesformular
    Bruger->>Frontend: Klikker 'Opret Bruger'

    activate Frontend
    Frontend->>Backend: createUserRequest(userData)
    activate Backend

    Backend->>Database: insertUser(userData)
    activate Database
    Database-->>Backend: returnSuccess(newUser.id)
    deactivate Database

    Backend-->>Frontend: creationSuccess("Bruger oprettet!")
    activate Frontend
    Frontend-->>Bruger: Viser success-side / sender til login
    deactivate Frontend
    deactivate Backend




(login)
    sequenceDiagram
    actor Bruger
    participant Frontend
    participant Backend
    participant Database

    Bruger->>Frontend: Indtaster brugernavn & password
    Bruger->>Frontend: Klikker 'Log Ind'

    activate Frontend
    Frontend->>Backend: sendLoginRequest(brugernavn, password)
    activate Backend

    Backend->>Database: findUser(brugernavn, hashedPassword)
    activate Database
    Database-->>Backend: returnUser(userData)
    deactivate Database

    alt Hvis bruger findes (login succes)
        Backend->>Database: getProjectsForUser(user.id)
        activate Database
        Database-->>Backend: returnProjects(projektListe)
        deactivate Database

        Backend-->>Frontend: loginSuccess(projektListe)
        activate Frontend
        Frontend-->>Bruger: Viser projektside
        deactivate Frontend

    else Hvis bruger ikke findes (login fejl)
        Backend-->>Frontend: loginFailure("Forkert bruger/pass")
        activate Frontend
        Frontend-->>Bruger: Viser fejlmeddelelse
        deactivate Frontend
    end

    deactivate Backend


(redigere projekt)
sequenceDiagram
    actor Bruger
    participant Frontend
    participant Backend
    participant Database

    Bruger->>Frontend: Vælger et projekt fra listen
    activate Frontend
    Frontend->>Backend: getProjectDetails(projectId)
    activate Backend
    Backend->>Database: fetchProjectData(projectId)
    activate Database
    Database-->>Backend: returnProjectData(data)
    deactivate Database
    Backend-->>Frontend: displayProjectDetails(data)
    deactivate Backend
    Frontend-->>Bruger: Viser projektdetaljer/redigeringsside
    deactivate Frontend

    alt Rediger data i projekt
        Bruger->>Frontend: Ændrer data (f.eks. opgave, indstilling)
        activate Frontend
        Frontend->>Backend: updateProjectData(projectId, updatedData)
        activate Backend
        Backend->>Database: saveProjectData(projectId, updatedData)
        activate Database
        Database-->>Backend: returnSuccess()
        deactivate Database
        Backend-->>Frontend: updateSuccess("Data opdateret!")
        deactivate Backend
        Frontend-->>Bruger: Bekræfter opdatering
        deactivate Frontend
    
    else Slet data fra projekt
        Bruger->>Frontend: Vælger at slette et element
        activate Frontend
        Frontend->>Backend: deleteProjectItem(projectId, itemId)
        activate Backend
        Backend->>Database: removeProjectItem(projectId, itemId)
        activate Database
        Database-->>Backend: returnSuccess()
        deactivate Database
        Backend-->>Frontend: deleteSuccess("Element slettet!")
        deactivate Backend
        Frontend-->>Bruger: Bekræfter sletning
        deactivate Frontend
    end


    ---
config:
  layout: elk
---
flowchart TB editfanout
    Start(["Bruger åbner EditFanout"]) --> CheckData{"Er der data?"}
    CheckData -- Ja --> EditMode["EDIT MODE<br>- Vis eksisterende data<br>- Vis Delete button<br>- Save button"]
    CheckData -- Nej --> CreateMode["CREATE MODE<br>- Tomme felter<br>- Skjul Delete button<br>- Create button"]
    EditMode --> TypeCheck{"Hvilken type?"}
    CreateMode --> TypeCheck
    TypeCheck -- project --> ProjectUI["ProjectForm<br>+ CourseSelect<br>+ UserManagement"]
    TypeCheck -- epic --> EpicUI["BasicForm<br>Title + Description"]
    TypeCheck -- feature --> FeatureUI["BasicForm<br>Title + Description"]
    TypeCheck -- task --> TaskUI["TaskForm<br>+ StatusSelect<br>+ Due Date<br>+ UserManagement"]
    ProjectUI --> UserEdit["Bruger redigerer felter"]
    EpicUI --> UserEdit
    FeatureUI --> UserEdit
    TaskUI --> UserEdit
    UserEdit --> Submit["Klikker Save/Create"]
    Submit --> Hook["useEditFanout hook<br>- Validerer data<br>- Kalder GraphQL<br>- Opdaterer UI"]
    Hook --> Success["Success Toast<br>Lukker EditFanout"]

    style Start fill:#e1f5ff
    style CheckData fill:#fff4e1
    style EditMode fill:#e8f5e9
    style CreateMode fill:#e8f5e9
    style TypeCheck fill:#fff4e1
    style ProjectUI fill:#f3e5f5
    style EpicUI fill:#f3e5f5
    style FeatureUI fill:#f3e5f5
    style TaskUI fill:#f3e5f5
    style Success fill:#c8e6c9


graph TD editfanout
    A[EditFanout Komponent] --> B{Hvilken type?}
    B -->|type = 'project'| C[ProjectForm]
    B -->|type = 'epic'| D[BasicForm - Epic]
    B -->|type = 'feature'| E[BasicForm - Feature]
    B -->|type = 'task'| F[TaskForm]
    
    C --> C1[Vis CourseSelect]
    C --> C2[Vis UserManagement]
    C --> C3[Title + Description]
    
    D --> D1[Title + Description]
    
    E --> E1[Title + Description]
    
    F --> F1[Title + Description]
    F --> F2[StatusSelect]
    F --> F3[Due Date]
    F --> F4[UserManagement]
    
    style A fill:#e1f5ff
    style C fill:#fff4e1
    style D fill:#fff4e1
    style E fill:#fff4e1
    style F fill:#fff4e1